# STM32 ADC + UART (HAL) Example

 –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ STM32, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–π —á—Ç–µ–Ω–∏–µ –∞–Ω–∞–ª–æ–≥–æ–≤–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ —á–µ—Ä–µ–∑ ADC –∏ –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö –ø–æ UART —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º HAL.

## üõ† –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

-  **MCU:** STM32F103C8T6 ("Blue Pill")
-  **–°—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:** STM32CubeIDE
-  **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:** STM32 HAL (CubeMX)
-  **–û—Ç–ª–∞–¥–∫–∞:** ST-Link V2

##  –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:

1. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç **ADC** –Ω–∞ –æ–¥–∏–Ω –∫–∞–Ω–∞–ª –≤ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ.
2. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **UART** –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –Ω–∞ –ü–ö (—á–µ—Ä–µ–∑ USB-UART CH340G).
3. –ü–µ—Ä–µ–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –≤–∏–¥–µ, —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
stm32-adc-uart-hal/
‚îú‚îÄ‚îÄ Core/                  # –ò—Å—Ö–æ–¥–Ω–∏–∫–∏ –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ Inc/               # –ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã (.h)
‚îÇ   ‚îî‚îÄ‚îÄ Src/               # –ò—Å—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã (.c)
‚îú‚îÄ‚îÄ Drivers/               # –î—Ä–∞–π–≤–µ—Ä—ã STM32 HAL
‚îú‚îÄ‚îÄ .gitignore             # –ò—Å–∫–ª—é—á–µ–Ω–∏—è Git
‚îú‚îÄ‚îÄ README.md              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ STM32CubeIDE/          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è IDE –∏ .project —Ñ–∞–π–ª—ã
‚îî‚îÄ‚îÄ .ioc                   # STM32CubeMX —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```
## ‚öôÔ∏è –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
```
STM32F103C8T6 ("Blue Pill"):

**PA1 (ADC1_IN1)** ‚Äî –∞–Ω–∞–ª–æ–≥–æ–≤—ã–π –≤—Ö–æ–¥ (–ø–æ–¥–∫–ª—é—á–∞–µ–º –∫ +3.3v —á–µ—Ä–µ–∑ –ø–æ—Ç–µ–Ω—Ü–∏–æ–º–µ—Ç—Ä 10–ö–û–º)
**PA9 (TX)** ‚Äî UART –ø–µ—Ä–µ–¥–∞—á–∞ (–∫ TX –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—è USB-UART CH340G)
**PA10 (RX)** ‚Äî UART –ø—Ä–∏—ë–º *(–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)*

–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å USB-UART CH340G:
**TX –∏ GND** USB-UART –∫ **PA9 –∏ GND** Blue Pill
```
- [–ú–æ–Ω—Ç–∞–∂–Ω–∞—è —Å—Ö–µ–º–∞](https://github.com/user-attachments/assets/d8eca711-790c-481c-9e2c-182399bc5016)
- [–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ ST-LINK V2](https://github.com/user-attachments/assets/11cf20ef-1757-43f4-bd80-f0e9caa32841)
- [–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ USB-UART CH340G](https://github.com/user-attachments/assets/635f70f6-237e-441c-b5aa-54983d74e659)

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–∏–∑ CubeMX)

| –ü–µ—Ä–∏—Ñ–µ—Ä–∏—è | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã               |
|-----------|-------------------------|
| ADC1      | Single channel, Polling |
| UART1     | 115200 baud, 8N1        |

–ê–¶–ü —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –∞–Ω–∞–ª–æ–≥–æ–≤–æ–≥–æ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è —Å –∫–∞–Ω–∞–ª–∞ ADC1_IN1 (–ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–≥–æ –∫ –≤—ã–≤–æ–¥—É PA1), –∫ –∫–æ—Ç–æ—Ä–æ–º—É –º–µ–∂–¥—É 3,3–í –∏ GND –ø–æ–¥–∫–ª—é—á–µ–Ω –ø–æ—Ç–µ–Ω—Ü–∏–æ–º–µ—Ç—Ä.

- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ CubeMX](https://github.com/user-attachments/assets/9efbe196-3f7a-48ba-95bf-639f2d71ce29)

–ù–∞ STM32F103C8T6 (–∏ –≤–æ–æ–±—â–µ –Ω–∞ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ STM32F1) —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ê–¶–ü (ADC) —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –∏ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 12 –±–∏—Ç. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –ê–¶–ü, –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 0 –¥–æ 4095. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º:
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ê–¶–ü = 2^12 - 1 = 4095.
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ê–¶–ü = 0.
- –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ +3.3V –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫ –≤—Ö–æ–¥—É –ê–¶–ü, —Ç–æ HAL_ADC_GetValue() –≤–µ—Ä–Ω—ë—Ç 4095.
- –ü—Ä–∏ 0V ‚Äî –±—É–¥–µ—Ç 0.
- –ü—Ä–∏ 1.65V ‚Äî –±—É–¥–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ 2047.

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–ü—Ä–æ–µ–∫—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–Ω–µ—à–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∫—Ä–æ–º–µ STM32 HAL.

## –ö–∞–∫ –ø—Ä–æ—à–∏—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

1. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ STM32CubeIDE.
2. –°–æ–±—Ä–∞—Ç—å (`Ctrl + B`).
3. –ü–æ–¥–∫–ª—é—á–∏—Ç—å ST-Link –∏ –ø—Ä–æ—à–∏—Ç—å (`Run ‚Üí Debug` / `Ctrl + F11`).
4. –ü–æ–¥–∫–ª—é—á–∏—Ç—å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å USB-UART CH340G.
5. –û—Ç–∫—Ä—ã—Ç—å –ª—é–±–æ–π —Ç–µ—Ä–º–∏–Ω–∞–ª –Ω–∞ –ü–ö(—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª UART Assistant v5.0.1), –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–≤ –Ω–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç –∏ –Ω–∞–±–ª—é–¥–∞—Ç—å –≤—ã–≤–æ–¥ –∑–Ω–∞—á–µ–Ω–∏–π. 

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ UART Assistant
- Channel: –≤—ã–±—Ä–∞—Ç—å —Ç–æ—Ç COM-Port, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø–æ–¥–∫–ª—é—á–µ–Ω USB-UART –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å–µ–ª—å.
- Baud rate: 115200.
- Data bits: 8.
- Stop bit: 1.
- Parity: None.
- Flowctrl: None.

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã

- [STM32 DHT11 UART](https://github.com/Metabolisto/stm32_dht11_uart) 